<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC
   "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

   <head>
      <script src = "../javascript/Color.js"></script>
      <script src = "../javascript/Square.js"></script>
      <script src = "../javascript/Shape.js"></script>
      <script src = "../javascript/Position.js"></script>
      <script src = "../javascript/Board.js"></script>
   </head>
   <body>
      <div style = "width:150px; height:100px; overflow: visible;">
         <svg xmlns="http://www.w3.org/2000/svg"></svg>
      </div>

      <script type="text/javascript">
      <!--
var svg = document.body.getElementsByTagName("svg")[0];

svg.setAttribute("height", Board.NUMBER_ROWS * 20);
svg.setAttribute("width", Board.NUMBER_COLUMNS * 20);

// draw board grid
var board = new Board();
board.appendTo(svg);

var squares = new Array(Board.NUMBER_COLUMNS);

for(var row = 0; row < Board.NUMBER_COLUMNS; row++) {
	squares[row] = new Square( );
	squares[row].setSize(20);
	squares[row].setColor(Color.GREEN);

	squares[row].setYCoordinate(0);
	squares[row].setXCoordinate(row * 20);
	squares[row].appendTo(svg);
}

var isHighlighted = false;

function drop() {
	if(isHighlighted) {
		// clear row, draw new row at top
		for(var row = 0; row < Board.NUMBER_COLUMNS; row++) {
			squares[row].setColor(Color.GREEN);
			squares[row].setYCoordinate(0);
		}

		isHighlighted = false;
		return;
	}

	var yCoordinate = squares[0].getYCoordinate() + 20;

	// if at bottom of board
	if(yCoordinate == (Board.NUMBER_ROWS * 20)) {

		// highlight row
		for(var row = 0; row < Board.NUMBER_COLUMNS; row++) {
			squares[row].setColor(Color.YELLOW);
		}

		isHighlighted = true;
		return;
	}

	for(var row = 0; row < Board.NUMBER_COLUMNS; row++) {
		yCoordinate = squares[row].getYCoordinate() + 20;
		squares[row].setYCoordinate(yCoordinate);
	}

	//window.clearInterval(interval); // stop timer
}

window.setInterval(drop, 500);

      //-->
      </script>
   </body>
</html>
